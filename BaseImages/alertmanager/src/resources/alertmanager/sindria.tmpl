{{ define "__xpipe_text_alert_list" }}{{ range . }}
---
ğŸªª <b>{{ .Labels.alertname }}</b>
{{- if .Annotations.summary }}
ğŸ“ {{ .Annotations.summary }}{{ end }}
{{- if .Annotations.description }}
ğŸ“– {{ .Annotations.description }}{{ end }}
ğŸ· Labels:
{{ range .Labels.SortedPairs }}  <i>{{ .Name }}</i>: <code>{{ .Value }}</code>
{{ end }}{{ end }}
ğŸ›  <a href="@@DASHBOARD_URL@@">Dashboard</a> ğŸ› 
{{ end }}

{{ define "telegram.xpipe.message" }}
{{ if gt (len .Alerts.Firing) 0 }}
ğŸ”¥ Alerts Firing ğŸ”¥
{{ template "__xpipe_text_alert_list" .Alerts.Firing }}
{{ end }}
{{ if gt (len .Alerts.Resolved) 0 }}
âœ… Alerts Resolved âœ…
{{ template "__xpipe_text_alert_list" .Alerts.Resolved }}
{{ end }}
{{ end }}


{{ define "__xpipe_subject" }}[{{ .Status | toUpper }}{{ if eq .Status "firing" }}:{{ .Alerts.Firing | len }}{{ end }}] {{ .GroupLabels.SortedPairs.Values | join " " }} {{ if gt (len .CommonLabels) (len .GroupLabels) }}({{ with .CommonLabels.Remove .GroupLabels.Names }}{{ .Values | join " " }}{{ end }}){{ end }}{{ end }}
{{ define "__description" }}{{ end }}

{{ define "__xpipe_text_alert_list_markdown" }}{{ range . }}
ğŸ· Labels:
{{ range .Labels.SortedPairs }}  - {{ .Name }} = {{ .Value }}
{{ end }}
ğŸ“– Annotations:
{{ range .Annotations.SortedPairs }}  - {{ .Name }} = {{ .Value }}
{{ end }}
ğŸ›  [Dashboard](@@DASHBOARD_URL@@) ğŸ› 
{{ end }}
{{ end }}

{{ define "teams.xpipe.summary" }}{{ template "__xpipe_subject" . }}{{ end }}
{{ define "teams.xpipe.title" }}{{ template "__xpipe_subject" . }}{{ end }}
{{ define "teams.xpipe.text" }}
{{ if gt (len .Alerts.Firing) 0 }}
# ğŸ”¥ Alerts Firing ğŸ”¥
{{ template "__xpipe_text_alert_list_markdown" .Alerts.Firing }}
{{ end }}
{{ if gt (len .Alerts.Resolved) 0 }}
# âœ… Alerts Resolved âœ…
{{ template "__xpipe_text_alert_list_markdown" .Alerts.Resolved }}
{{ end }}
{{ end }}